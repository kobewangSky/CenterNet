import cv2
import time
import numpy as np
from scipy import ndimage
from scipy import signal
from multiprocessing import Pool, cpu_count
import matplotlib.pyplot as plt
import math
import glob
import os

# cnn parameter

# v1 parameter
window_v1 = [[[[0.0777, -0.0326, 0.0884, -0.0412, -0.0106, -0.0924, 0.0543],
               [0.0704, -0.0674, -0.0291, -0.1120, -0.0698, -0.1009, -0.0436],
               [0.0378, -0.0859, -0.1149, -0.1490, -0.0020, -0.1077, 0.0196],
               [-0.0383, 0.0171, -0.0762, -0.0861, -0.1179, -0.1711, 0.0247],
               [0.0480, -0.0889, -0.0454, 0.0065, -0.1747, -0.0918, -0.1038],
               [0.0374, 0.0518, 0.0472, -0.0850, -0.0520, 0.0269, 0.0066],
               [0.0499, 0.0512, -0.0026, 0.1053, -0.0354, 0.0418, 0.0265]],

              [[0.0306, 0.0203, -0.0281, 0.0778, -0.0173, -0.0401, -0.0481],
               [-0.1023, -0.1091, -0.0783, 0.0941, 0.0663, -0.0114, -0.0019],
               [0.0512, -0.0087, -0.0680, -0.0251, 0.2113, -0.0299, -0.0110],
               [0.0684, 0.0028, 0.1440, 0.1215, 0.0037, 0.0314, -0.0455],
               [-0.0208, 0.0486, 0.0683, 0.0518, 0.0201, -0.0217, 0.0211],
               [-0.0417, 0.0069, -0.0736, 0.0155, -0.0937, 0.0151, -0.0496],
               [0.0001, -0.0564, -0.0883, 0.0611, 0.0400, -0.0643, -0.0229]],

              [[0.0008, 0.0444, -0.0395, 0.1225, -0.0450, -0.0545, -0.0393],
               [-0.0776, -0.0101, 0.0443, 0.1430, 0.1612, 0.1105, 0.0139],
               [0.0286, -0.0195, -0.0581, 0.2020, 0.3227, 0.1037, 0.0634],
               [-0.0798, -0.0669, 0.1839, 0.1592, 0.2752, 0.0969, 0.0734],
               [-0.0112, -0.0033, 0.0449, 0.1055, 0.0748, 0.1287, -0.0592],
               [-0.0177, -0.0167, -0.0348, -0.0216, -0.0506, 0.0995, 0.0527],
               [0.0424, -0.0501, -0.0031, 0.0226, -0.0317, -0.0311, -0.0772]]],

             [[[0.0170, -0.0511, -0.0226, -0.0265, -0.0801, -0.0958, -0.0572],
               [-0.0131, -0.0203, -0.0615, 0.0400, 0.0896, -0.0221, -0.0665],
               [0.0588, -0.0516, -0.1823, -0.1323, 0.1568, -0.0019, 0.0150],
               [-0.0491, -0.0540, -0.0064, 0.0148, 0.0420, 0.0143, -0.0823],
               [0.0004, -0.0261, -0.0704, 0.0669, -0.0462, -0.0443, 0.0550],
               [-0.0268, -0.0057, 0.0077, 0.0196, -0.1048, 0.0107, -0.0632],
               [0.0227, -0.0103, -0.0473, -0.0031, -0.0069, -0.0384, 0.0097]],

              [[0.0138, -0.0216, 0.1356, 0.1162, 0.0363, 0.0049, -0.0123],
               [-0.0963, -0.0692, -0.0985, 0.0076, 0.2007, 0.0992, 0.0498],
               [0.0494, -0.0004, -0.0451, 0.1646, 0.3726, 0.1769, 0.0692],
               [-0.0368, 0.0380, 0.2538, 0.3374, 0.3161, 0.1295, 0.0934],
               [0.0348, 0.0623, 0.0359, 0.2250, 0.0554, 0.0270, 0.1310],
               [0.0645, -0.0398, 0.0269, 0.0538, 0.0890, 0.0079, 0.0057],
               [-0.0410, 0.0922, 0.0008, 0.0271, 0.0721, 0.1170, 0.0306]],

              [[0.0253, 0.0822, 0.0485, -0.0321, -0.0008, -0.0814, -0.0272],
               [0.0208, -0.0300, -0.0815, -0.0355, 0.0902, -0.1545, -0.1040],
               [-0.0411, -0.0153, -0.1514, -0.1813, 0.1372, -0.1292, -0.0098],
               [0.0727, -0.0167, 0.0309, 0.0454, -0.0794, -0.1433, -0.0960],
               [0.0124, -0.0968, 0.0221, 0.0126, -0.0984, -0.1512, 0.0360],
               [0.0302, -0.0533, -0.0633, -0.0943, -0.1652, -0.1182, -0.0082],
               [-0.0523, 0.0579, -0.0717, 0.0054, -0.0754, 0.0059, -0.0698]]],

             [[[-0.0974, 0.0908, 0.0630, 0.1423, -0.0224, -0.0260, 0.0618],
               [0.0094, 0.0705, 0.0486, -0.0132, 0.1803, 0.0117, 0.0302],
               [-0.0088, 0.1072, -0.0196, 0.0531, 0.2637, 0.0680, -0.0851],
               [-0.0556, 0.0513, 0.1928, 0.3356, 0.2386, 0.0288, 0.0601],
               [0.0597, 0.0575, 0.0336, 0.0849, 0.1251, 0.1045, 0.0210],
               [0.0048, -0.0561, -0.0572, -0.0358, -0.0210, 0.0476, 0.0722],
               [-0.0061, -0.0064, 0.0795, 0.0574, -0.0165, -0.0040, 0.0281]],

              [[0.0273, -0.0117, 0.0621, 0.0884, -0.0221, -0.0823, -0.0901],
               [0.0135, -0.1313, -0.1784, -0.0649, 0.1262, -0.0722, -0.0422],
               [0.0195, -0.0209, -0.1203, -0.0289, 0.0663, -0.0515, -0.0828],
               [-0.0025, 0.0122, 0.1411, 0.2206, 0.0866, -0.1105, -0.0610],
               [-0.0182, -0.1629, -0.0323, -0.0563, -0.1010, -0.0065, -0.0397],
               [-0.0615, -0.0634, -0.1289, -0.0867, -0.1025, 0.0369, -0.0056],
               [-0.0414, 0.0643, -0.0348, 0.0318, -0.0002, -0.0085, -0.0078]],

              [[-0.0723, 0.0073, -0.0295, 0.0557, 0.0385, -0.0178, -0.0185],
               [0.0431, -0.0887, -0.1252, -0.0598, 0.0788, 0.0004, 0.0622],
               [0.0494, 0.0454, 0.0207, 0.0166, 0.1300, -0.0237, -0.0935],
               [-0.0264, -0.0014, 0.1806, 0.2008, 0.0601, 0.0349, 0.0372],
               [-0.0043, -0.0204, 0.0866, 0.0832, 0.0493, 0.0597, 0.0439],
               [0.0507, 0.0524, -0.0321, -0.0397, 0.0017, -0.0377, -0.0912],
               [-0.0321, -0.0547, 0.0735, -0.0513, -0.0662, -0.0641, 0.0508]]]]

# v2 parameter
window_v2 = [[[[-0.0268, -0.0065, 0.0110, 0.0135, -0.0026, -0.0156, -0.0233],
               [-0.0043, 0.0320, 0.0743, 0.0864, 0.0589, 0.0177, -0.0102],
               [0.0097, 0.0689, 0.1384, 0.1712, 0.1413, 0.0723, 0.0112],
               [-0.0027, 0.0744, 0.1655, 1.2196, 0.1880, 0.0949, 0.0083],
               [-0.0050, 0.0716, 0.1564, 0.2092, 0.1702, 0.0814, -0.0018],
               [-0.0161, 0.0266, 0.0834, 0.1104, 0.0862, 0.0303, -0.0200],
               [-0.0279, -0.0163, 0.0126, 0.0221, 0.0074, -0.0229, -0.0453]],

              [[-0.0141, -0.0179, -0.0236, -0.0311, -0.0320, -0.0176, 0.0041],
               [-0.0209, -0.0452, -0.0603, -0.0719, -0.0722, -0.0525, -0.0153],
               [-0.0295, -0.0722, -0.1004, -0.1101, -0.1064, -0.0770, -0.0284],
               [-0.0448, -0.0934, -0.1281, 0.8704, -0.1219, -0.0919, -0.0440],
               [-0.0325, -0.0761, -0.1141, -0.1182, -0.1116, -0.0764, -0.0342],
               [-0.0136, -0.0474, -0.0769, -0.0943, -0.0816, -0.0487, -0.0153],
               [0.0099, -0.0073, -0.0184, -0.0350, -0.0316, -0.0203, -0.0047]],

              [[0.0326, 0.0329, 0.0239, 0.0093, 0.0091, 0.0257, 0.0378],
               [0.0354, 0.0041, -0.0307, -0.0561, -0.0443, -0.0036, 0.0347],
               [0.0298, -0.0320, -0.0969, -0.1280, -0.0984, -0.0276, 0.0327],
               [0.0169, -0.0583, -0.1346, 0.8385, -0.1234, -0.0438, 0.0227],
               [0.0275, -0.0368, -0.1079, -0.1312, -0.0984, -0.0233, 0.0335],
               [0.0369, -0.0041, -0.0485, -0.0723, -0.0420, 0.0112, 0.0446],
               [0.0439, 0.0291, 0.0199, 0.0059, 0.0195, 0.0362, 0.0416]]],

             [[[0.0018, -0.0028, -0.0155, -0.0276, -0.0142, 0.0055, 0.0137],
               [0.0026, -0.0171, -0.0398, -0.0602, -0.0507, -0.0246, -0.0014],
               [-0.0168, -0.0520, -0.0967, -0.1232, -0.1008, -0.0487, -0.0101],
               [-0.0377, -0.0767, -0.1268, 0.8548, -0.1174, -0.0660, -0.0296],
               [-0.0208, -0.0455, -0.0826, -0.0963, -0.0811, -0.0459, -0.0192],
               [-0.0027, -0.0149, -0.0362, -0.0597, -0.0517, -0.0231, -0.0015],
               [-0.0045, -0.0095, -0.0211, -0.0448, -0.0411, -0.0224, -0.0094]],

              [[-0.0026, 0.0100, 0.0242, 0.0348, 0.0320, 0.0189, 0.0048],
               [0.0181, 0.0405, 0.0787, 0.1029, 0.0847, 0.0469, 0.0208],
               [0.0335, 0.0765, 0.1407, 0.1842, 0.1441, 0.0820, 0.0344],
               [0.0377, 0.0932, 0.1768, 1.2446, 0.1865, 0.0974, 0.0303],
               [0.0327, 0.0749, 0.1376, 0.1931, 0.1540, 0.0867, 0.0287],
               [0.0176, 0.0441, 0.0792, 0.0999, 0.0891, 0.0613, 0.0260],
               [-0.0038, 0.0174, 0.0409, 0.0436, 0.0382, 0.0236, 0.0013]],

              [[0.0102, -0.0019, -0.0164, -0.0252, -0.0207, -0.0078, 0.0002],
               [-0.0022, -0.0356, -0.0629, -0.0726, -0.0672, -0.0415, -0.0095],
               [-0.0257, -0.0722, -0.1140, -0.1257, -0.1178, -0.0736, -0.0253],
               [-0.0392, -0.0885, -0.1332, 0.8602, -0.1343, -0.0906, -0.0424],
               [-0.0250, -0.0738, -0.1231, -0.1330, -0.1235, -0.0751, -0.0302],
               [-0.0068, -0.0390, -0.0751, -0.0948, -0.0798, -0.0355, -0.0040],
               [0.0009, -0.0059, -0.0151, -0.0301, -0.0235, -0.0047, 0.0011]]],

             [[[0.0224, 0.0316, 0.0303, 0.0245, 0.0392, 0.0358, 0.0117],
               [0.0371, 0.0227, -0.0104, -0.0342, -0.0063, 0.0258, 0.0310],
               [0.0372, -0.0052, -0.0831, -0.1374, -0.0889, -0.0081, 0.0351],
               [0.0243, -0.0302, -0.1306, 0.8043, -0.1390, -0.0432, 0.0151],
               [0.0358, -0.0062, -0.0808, -0.1311, -0.0911, -0.0210, 0.0232],
               [0.0396, 0.0180, -0.0136, -0.0435, -0.0183, 0.0171, 0.0361],
               [0.0227, 0.0257, 0.0264, 0.0145, 0.0282, 0.0359, 0.0263]],

              [[0.0077, -0.0131, -0.0366, -0.0468, -0.0321, -0.0177, -0.0110],
               [-0.0080, -0.0526, -0.0950, -0.1090, -0.0882, -0.0519, -0.0203],
               [-0.0297, -0.0864, -0.1412, -0.1624, -0.1425, -0.0889, -0.0363],
               [-0.0471, -0.1033, -0.1539, 0.8322, -0.1555, -0.1110, -0.0559],
               [-0.0383, -0.0936, -0.1386, -0.1489, -0.1346, -0.0945, -0.0450],
               [-0.0190, -0.0619, -0.0946, -0.1081, -0.0882, -0.0554, -0.0178],
               [-0.0008, -0.0200, -0.0341, -0.0427, -0.0303, -0.0167, -0.0044]],

              [[-0.0195, -0.0101, 0.0074, 0.0201, 0.0169, -0.0006, -0.0209],
               [-0.0094, 0.0182, 0.0631, 0.0951, 0.0757, 0.0305, -0.0087],
               [0.0045, 0.0655, 0.1546, 0.2117, 0.1648, 0.0762, 0.0082],
               [0.0106, 0.0909, 0.2083, 1.2863, 0.2179, 0.0953, 0.0114],
               [0.0104, 0.0693, 0.1574, 0.2172, 0.1646, 0.0726, 0.0112],
               [0.0018, 0.0257, 0.0694, 0.0946, 0.0749, 0.0344, 0.0071],
               [-0.0101, -0.0066, 0.0104, 0.0197, 0.0161, 0.0023, -0.0090]]]]

# add sigmoid
window_v3 = [[[[-2.4967e-02, -8.8830e-03, 8.7995e-03, 5.1257e-03, 9.6059e-05,
                -1.3396e-02, -3.0581e-02],
               [-1.1539e-02, 2.9131e-02, 6.5295e-02, 6.7923e-02, 5.3640e-02,
                1.8870e-02, -1.7845e-02],
               [1.2151e-03, 5.8486e-02, 9.6284e-02, 9.2540e-02, 9.4773e-02,
                5.6736e-02, 5.5986e-03],
               [-2.6662e-03, 5.6540e-02, 8.3344e-02, 1.0412e+00, 8.3099e-02,
                5.6224e-02, 7.4029e-03],
               [-3.9906e-03, 6.0701e-02, 1.0183e-01, 1.0039e-01, 9.8145e-02,
                5.4181e-02, 7.3911e-03],
               [-2.5407e-02, 2.7391e-02, 6.1328e-02, 6.8098e-02, 5.6281e-02,
                2.0255e-02, -1.2148e-02],
               [-4.6716e-02, -1.5206e-02, 4.1220e-03, 1.0286e-02, 6.1648e-03,
                -1.8001e-02, -3.2524e-02]],

              [[-6.0666e-03, -1.5228e-02, -2.1016e-02, -3.3505e-02, -2.1299e-02,
                -1.0910e-02, -1.6915e-03],
               [-1.1538e-02, -3.1502e-02, -5.2581e-02, -7.5262e-02, -5.7503e-02,
                -3.4437e-02, -1.4971e-02],
               [-1.9985e-02, -5.7373e-02, -1.1171e-01, -1.5672e-01, -1.1132e-01,
                -5.6351e-02, -2.6329e-02],
               [-3.0447e-02, -8.0466e-02, -1.5965e-01, 7.5518e-01, -1.6207e-01,
                -8.3851e-02, -3.7597e-02],
               [-1.8936e-02, -5.4082e-02, -1.0878e-01, -1.5102e-01, -1.1416e-01,
                -6.3765e-02, -2.5358e-02],
               [-1.2475e-02, -3.0786e-02, -6.3578e-02, -8.4169e-02, -6.6858e-02,
                -4.1246e-02, -1.2776e-02],
               [-1.4207e-03, -6.2080e-03, -2.1646e-02, -3.1339e-02, -2.3787e-02,
                -2.1248e-02, -8.4081e-03]],

              [[3.2122e-02, 2.5654e-02, 2.1951e-02, 9.4986e-03, 2.2713e-02,
                3.0228e-02, 3.2491e-02],
               [3.5440e-02, 1.0366e-02, -1.9338e-02, -4.6394e-02, -2.2027e-02,
                8.3712e-03, 2.9333e-02],
               [3.1466e-02, -1.7840e-02, -8.8871e-02, -1.4064e-01, -8.6273e-02,
                -1.4979e-02, 2.8713e-02],
               [2.2025e-02, -4.1805e-02, -1.3854e-01, 7.7479e-01, -1.3665e-01,
                -3.8851e-02, 2.4317e-02],
               [3.3010e-02, -1.4753e-02, -8.6370e-02, -1.3203e-01, -8.2447e-02,
                -1.3807e-02, 3.4869e-02],
               [3.4727e-02, 1.0387e-02, -3.1240e-02, -5.2739e-02, -2.4086e-02,
                1.2390e-02, 4.0908e-02],
               [3.5614e-02, 3.1751e-02, 1.4988e-02, 6.4737e-03, 2.0547e-02,
                2.5102e-02, 2.9784e-02]]],

             [[[-7.9727e-03, -5.8841e-04, -5.4069e-03, -2.7337e-02, -7.5394e-03,
                -3.8382e-03, -7.1206e-04],
               [-8.7521e-03, -1.0976e-02, -2.9346e-02, -5.7837e-02, -3.7535e-02,
                -2.0429e-02, -2.4543e-03],
               [-1.6015e-02, -4.0022e-02, -8.4316e-02, -1.3389e-01, -9.3220e-02,
                -4.3490e-02, -1.0584e-02],
               [-3.1928e-02, -6.7097e-02, -1.3625e-01, 7.7815e-01, -1.3576e-01,
                -6.5059e-02, -2.5187e-02],
               [-2.2118e-02, -3.8789e-02, -8.5263e-02, -1.3080e-01, -8.6646e-02,
                -4.5214e-02, -1.3619e-02],
               [-7.2110e-03, -5.2845e-03, -2.9855e-02, -6.2287e-02, -3.9665e-02,
                -1.8715e-02, -3.6181e-03],
               [-4.2459e-04, -1.6787e-03, -1.7405e-02, -4.1125e-02, -1.7440e-02,
                -7.3453e-03, 2.6300e-03]],

              [[-1.4499e-02, 1.2059e-02, 2.8093e-02, 1.9725e-02, 2.5371e-02,
                5.5555e-03, -1.3397e-02],
               [4.0316e-03, 3.8103e-02, 6.5327e-02, 6.6051e-02, 6.0400e-02,
                3.0325e-02, 5.5359e-03],
               [2.6324e-02, 6.5185e-02, 1.0404e-01, 1.0438e-01, 9.2039e-02,
                5.6286e-02, 1.9956e-02],
               [2.6430e-02, 6.8587e-02, 1.0844e-01, 1.0887e+00, 9.9332e-02,
                6.2754e-02, 1.7927e-02],
               [2.5560e-02, 6.3688e-02, 1.0159e-01, 1.1039e-01, 1.0280e-01,
                5.8426e-02, 1.9647e-02],
               [9.8114e-03, 3.8425e-02, 6.2747e-02, 6.8260e-02, 6.3941e-02,
                3.5737e-02, 4.6394e-03],
               [-9.3752e-03, 1.2227e-02, 2.3053e-02, 2.2028e-02, 3.0008e-02,
                9.7277e-03, -1.0742e-02]],

              [[6.9188e-04, 7.4130e-03, -1.0942e-03, -2.4561e-02, -4.6649e-03,
                -4.7040e-03, -3.6623e-03],
               [-5.5536e-03, -1.7886e-02, -4.5193e-02, -7.1707e-02, -4.4178e-02,
                -2.4374e-02, -2.2350e-03],
               [-1.5597e-02, -5.2465e-02, -1.0625e-01, -1.4962e-01, -1.0612e-01,
                -5.1620e-02, -1.0803e-02],
               [-3.0709e-02, -8.3357e-02, -1.6169e-01, 7.6004e-01, -1.5707e-01,
                -7.6086e-02, -2.8730e-02],
               [-1.5608e-02, -6.0507e-02, -1.2382e-01, -1.6468e-01, -1.1515e-01,
                -5.7268e-02, -1.6859e-02],
               [2.1028e-03, -2.2945e-02, -6.4908e-02, -8.8498e-02, -5.8262e-02,
                -2.4317e-02, -5.1599e-03],
               [1.0163e-02, 5.5803e-03, -1.7140e-02, -3.0884e-02, -6.1948e-03,
                2.8215e-04, -2.0699e-04]]],

             [[[6.0270e-03, 3.0750e-02, 3.7671e-02, 2.7503e-02, 3.0693e-02,
                3.1125e-02, 1.8313e-02],
               [3.4204e-02, 3.4701e-02, 1.4295e-02, -2.2064e-02, -1.7104e-03,
                1.8781e-02, 2.7304e-02],
               [3.5794e-02, 8.1783e-03, -6.4181e-02, -1.3434e-01, -7.9110e-02,
                -5.7725e-03, 3.1290e-02],
               [1.6871e-02, -2.6736e-02, -1.3405e-01, 7.3390e-01, -1.3652e-01,
                -2.4999e-02, 2.4231e-02],
               [2.9315e-02, 4.2228e-03, -6.9463e-02, -1.2802e-01, -7.6655e-02,
                -9.9211e-04, 3.2072e-02],
               [3.3434e-02, 3.3381e-02, 1.3482e-03, -3.1088e-02, -3.7161e-03,
                2.4685e-02, 3.9924e-02],
               [1.4531e-02, 3.0951e-02, 3.4126e-02, 1.7533e-02, 2.5179e-02,
                2.8938e-02, 2.5049e-02]],

              [[7.3814e-03, -3.7276e-03, -2.6265e-02, -4.1211e-02, -2.4924e-02,
                -4.0013e-03, 5.2573e-03],
               [-3.8432e-03, -3.7422e-02, -7.4520e-02, -1.0251e-01, -7.0033e-02,
                -3.3811e-02, -5.7227e-03],
               [-2.7614e-02, -7.6263e-02, -1.4547e-01, -1.9631e-01, -1.3998e-01,
                -6.8428e-02, -2.0437e-02],
               [-4.6795e-02, -1.0017e-01, -1.9303e-01, 6.9464e-01, -1.8794e-01,
                -9.2556e-02, -3.5332e-02],
               [-3.1051e-02, -7.0582e-02, -1.3643e-01, -1.8106e-01, -1.4024e-01,
                -7.1791e-02, -2.6475e-02],
               [-1.7263e-02, -3.8695e-02, -7.5522e-02, -1.0321e-01, -7.4941e-02,
                -3.9340e-02, -7.8752e-03],
               [-1.3739e-02, -1.8160e-02, -2.6805e-02, -4.3205e-02, -3.2230e-02,
                -1.6832e-02, -4.0202e-03]],

              [[-2.8481e-02, -1.2485e-02, -3.3099e-03, -1.6455e-03, -2.5393e-03,
                -1.3545e-02, -3.2143e-02],
               [-1.1158e-02, 1.7969e-02, 4.9500e-02, 5.5304e-02, 5.2647e-02,
                1.6488e-02, -1.9555e-02],
               [-4.8275e-03, 4.9026e-02, 9.6595e-02, 1.0558e-01, 1.0297e-01,
                5.3298e-02, -2.1628e-03],
               [-5.8247e-03, 5.7380e-02, 1.0385e-01, 1.0680e+00, 1.0811e-01,
                6.0328e-02, -2.0250e-03],
               [3.3198e-03, 5.6257e-02, 1.0050e-01, 1.1756e-01, 9.7587e-02,
                5.0249e-02, -1.2439e-03],
               [-4.6637e-03, 2.7407e-02, 5.3528e-02, 6.1006e-02, 5.2895e-02,
                2.0061e-02, -7.1062e-03],
               [-2.8347e-02, -1.2633e-02, 1.9334e-03, -8.3981e-05, -5.5624e-03,
                -1.8032e-02, -2.8292e-02]]]]

# add sigmoid without identical
window_v4 = [[[[-0.0031, -0.0814, 0.0544, -0.0339, 0.0422, -0.0531, 0.0114],
               [0.0159, -0.0279, 0.0968, 0.0191, 0.0115, -0.0174, -0.0494],
               [0.0022, -0.0113, 0.0962, 0.1401, 0.1558, 0.0219, 0.0504],
               [-0.0291, 0.1217, 0.1655, 0.3368, 0.1765, 0.0074, 0.0621],
               [0.0228, -0.0164, 0.1376, 0.3290, 0.0821, 0.0332, -0.0966],
               [-0.0165, 0.0536, 0.0944, 0.0177, 0.0508, 0.0683, -0.0164],
               [-0.0351, -0.0113, -0.0319, 0.0792, -0.0507, -0.0063, -0.0486]],

              [[0.0245, 0.0014, -0.0809, 0.0226, -0.0203, 0.0088, -0.0107],
               [-0.0894, -0.0788, -0.0575, 0.0245, -0.0626, -0.0346, 0.0048],
               [0.0310, -0.0274, -0.0884, -0.1010, 0.0111, -0.0996, -0.0164],
               [0.0419, -0.0587, 0.0579, 0.0870, -0.1034, -0.0087, -0.0552],
               [-0.0674, -0.0037, 0.0037, 0.0337, -0.0176, -0.0453, 0.0220],
               [-0.0700, -0.0257, -0.1264, -0.0377, -0.1218, 0.0189, -0.0142],
               [-0.0036, -0.0663, -0.1043, 0.0215, 0.0298, -0.0514, 0.0174]],

              [[0.0449, 0.0675, -0.0637, 0.0728, -0.0453, 0.0120, 0.0320],
               [-0.0043, 0.0435, 0.0387, 0.0013, -0.0337, 0.0628, 0.0348],
               [0.0830, -0.0169, -0.1366, -0.0106, -0.0086, -0.0338, 0.0474],
               [-0.0223, -0.0942, 0.0395, -0.0327, 0.0168, -0.0297, 0.0401],
               [0.0320, -0.0019, -0.0405, -0.0113, -0.0625, 0.0497, -0.0652],
               [0.0320, 0.0188, -0.0582, -0.0908, -0.1031, 0.0958, 0.1035],
               [0.1041, 0.0176, 0.0473, 0.0302, -0.0045, 0.0169, -0.0027]]],

             [[[0.0210, -0.0466, -0.0358, -0.0322, -0.0161, 0.0003, -0.0113],
               [-0.0067, 0.0224, 0.0148, 0.0216, -0.0042, 0.0131, -0.0339],
               [0.0492, -0.0495, -0.1081, -0.1092, -0.0310, -0.0417, 0.0448],
               [-0.0377, -0.0746, -0.0138, 0.0859, -0.0519, -0.0271, -0.0864],
               [0.0021, -0.0346, -0.0845, 0.1178, -0.0561, -0.0739, 0.0362],
               [-0.0315, -0.0145, -0.0180, -0.0029, -0.1162, 0.0132, -0.0404],
               [0.0177, -0.0134, -0.0569, -0.0153, 0.0001, -0.0349, 0.0247]],

              [[0.0170, -0.0312, 0.0839, 0.0405, 0.0097, 0.0388, -0.0177],
               [-0.0406, 0.0331, 0.0196, -0.0369, 0.0115, 0.0587, 0.0057],
               [0.0674, 0.0538, 0.0818, 0.1840, 0.1036, 0.0784, 0.0192],
               [-0.0385, 0.0271, 0.2729, 0.4404, 0.2060, 0.0749, 0.0236],
               [0.0223, 0.0834, 0.0811, 0.3537, 0.0953, 0.0088, 0.0527],
               [0.0479, -0.0253, 0.0561, 0.0908, 0.1116, -0.0028, -0.0342],
               [-0.0507, 0.0858, -0.0114, 0.0013, 0.0440, 0.0753, -0.0083]],

              [[-0.0168, 0.0344, -0.0141, -0.0779, 0.0280, 0.0166, 0.0182],
               [0.0158, 0.0026, -0.0122, -0.0518, 0.0097, -0.0751, -0.0555],
               [-0.0772, -0.0273, -0.0804, -0.1509, -0.0035, -0.0833, 0.0516],
               [0.0390, -0.0789, -0.0111, 0.1037, -0.1115, -0.0809, -0.0674],
               [-0.0143, -0.1168, 0.0068, 0.0791, -0.0399, -0.0917, 0.0389],
               [0.0165, -0.0547, -0.0673, -0.0806, -0.1204, -0.0616, 0.0193],
               [-0.0386, 0.0748, -0.0688, 0.0070, -0.0476, 0.0414, -0.0485]]],

             [[[-0.0583, 0.0937, 0.0162, 0.0752, -0.0350, -0.0014, 0.0490],
               [0.0162, 0.0757, 0.0635, -0.0868, 0.0546, 0.0275, 0.0482],
               [-0.0265, 0.0304, -0.0975, -0.0760, 0.0021, 0.0154, -0.0388],
               [-0.0284, -0.0186, 0.0242, 0.1495, 0.0074, -0.0536, 0.0691],
               [0.0881, 0.0468, -0.0343, -0.0058, 0.0146, 0.0210, 0.0017],
               [0.0320, -0.0516, -0.0674, -0.0723, -0.0514, 0.0138, 0.0784],
               [0.0138, -0.0073, 0.0836, 0.0614, 0.0100, -0.0077, 0.0183]],

              [[0.0558, -0.0159, 0.0084, 0.0173, -0.0379, -0.0170, -0.0329],
               [0.0344, -0.0854, -0.1102, -0.0985, 0.0005, -0.0420, 0.0053],
               [0.0015, -0.0620, -0.1221, -0.0804, -0.1551, -0.0693, -0.0146],
               [-0.0069, -0.0616, 0.0103, 0.1172, -0.0770, -0.1403, -0.0335],
               [-0.0056, -0.1578, -0.0537, -0.0665, -0.1524, -0.0526, -0.0576],
               [-0.0319, -0.0430, -0.1100, -0.0798, -0.1037, 0.0183, -0.0069],
               [-0.0081, 0.0574, -0.0571, 0.0060, -0.0016, -0.0239, -0.0217]],

              [[-0.0723, 0.0027, -0.0547, 0.0264, 0.0246, -0.0051, -0.0402],
               [0.0326, -0.0295, 0.0075, 0.0139, 0.0370, 0.0253, 0.0425],
               [0.0128, 0.0634, 0.1642, 0.1739, 0.0916, 0.0207, -0.0638],
               [-0.0435, -0.0026, 0.2484, 0.3927, 0.1268, 0.0994, 0.0495],
               [-0.0178, 0.0164, 0.1884, 0.2790, 0.1692, 0.0961, 0.0270],
               [0.0356, 0.0667, 0.0344, 0.0670, 0.0940, -0.0017, -0.0829],
               [-0.0421, -0.0822, 0.0619, -0.0351, -0.0216, -0.0446, 0.0496]]]]

# regulization sigmoid
window_v5 = [[[[-0.0462, -0.0905, 0.0541, -0.0540, 0.0273, -0.0714, -0.0293],
               [0.0218, 0.0152, 0.1428, 0.0415, 0.0639, -0.0025, -0.0729],
               [-0.0061, 0.0563, 0.3376, 0.3485, 0.3607, 0.0627, 0.0335],
               [-0.0398, 0.1769, 0.4427, 0.1040, 0.4317, 0.0387, 0.0502],
               [-0.0215, -0.0064, 0.3810, 0.5434, 0.2851, 0.0255, -0.1152],
               [-0.0547, 0.0531, 0.1663, 0.0725, 0.0941, 0.0285, -0.0527],
               [-0.1072, -0.0231, -0.0379, 0.0428, -0.0783, -0.0324, -0.0925]],

              [[-0.0002, -0.0083, -0.0801, -0.0024, -0.0327, -0.0018, -0.0243],
               [-0.0938, -0.0793, -0.0723, -0.0202, -0.0573, -0.0487, -0.0178],
               [0.0163, -0.0174, 0.0517, 0.0081, 0.1490, -0.0988, -0.0377],
               [0.0424, -0.0442, 0.2308, -0.2013, 0.0720, -0.0180, -0.0738],
               [-0.0751, -0.0149, 0.1739, 0.1742, 0.1417, -0.0667, 0.0158],
               [-0.0609, -0.0345, -0.0924, -0.0172, -0.0843, -0.0112, -0.0184],
               [-0.0020, -0.0513, -0.1008, -0.0072, 0.0297, -0.0361, 0.0407]],

              [[0.1052, 0.1154, -0.0129, 0.0828, -0.0078, 0.0546, 0.0910],
               [0.0537, 0.0644, 0.0332, -0.0500, -0.0118, 0.0766, 0.0733],
               [0.1287, -0.0006, -0.0332, 0.0347, 0.1028, -0.0234, 0.0843],
               [0.0132, -0.1136, 0.1265, -0.3910, 0.1143, -0.0667, 0.0564],
               [0.0685, -0.0304, 0.0735, 0.0518, 0.0490, 0.0153, -0.0331],
               [0.0916, 0.0078, -0.0466, -0.1129, -0.0871, 0.0623, 0.1369],
               [0.1864, 0.0681, 0.0726, 0.0059, 0.0113, 0.0538, 0.0730]]],

             [[[0.0414, -0.0504, -0.0301, -0.0385, -0.0219, -0.0052, -0.0147],
               [-0.0109, -0.0148, -0.0431, -0.0588, -0.0458, -0.0242, -0.0485],
               [0.0371, -0.1040, -0.0688, -0.1072, 0.0270, -0.1047, 0.0654],
               [-0.0901, -0.1596, 0.1264, -0.0710, 0.0126, -0.1259, -0.1082],
               [-0.0301, -0.1313, 0.0750, 0.2598, 0.0497, -0.1354, 0.0497],
               [-0.0235, -0.1048, -0.0510, -0.0295, -0.1623, -0.0536, -0.0461],
               [0.0541, -0.0111, -0.0856, -0.0301, -0.0176, -0.0271, 0.0378]],

              [[0.0428, -0.0081, 0.1420, 0.0994, 0.0693, 0.0830, 0.0048],
               [-0.0143, 0.0528, 0.0404, -0.0264, 0.0647, 0.0938, 0.0329],
               [0.1271, 0.1161, 0.2822, 0.3545, 0.3207, 0.1233, 0.0982],
               [0.0099, 0.1084, 0.6491, 0.4844, 0.4751, 0.0984, 0.0656],
               [0.0766, 0.1294, 0.4730, 0.7494, 0.4008, 0.0611, 0.1274],
               [0.1039, -0.0353, 0.1527, 0.2103, 0.1890, 0.0128, 0.0035],
               [-0.0004, 0.1204, 0.0197, 0.0590, 0.0962, 0.1327, 0.0292]],

              [[0.0369, 0.0542, 0.0110, -0.0771, 0.0361, 0.0351, 0.0554],
               [0.0183, -0.0464, -0.0941, -0.1742, -0.0595, -0.1216, -0.0529],
               [-0.0695, -0.0812, -0.0600, -0.1904, 0.0217, -0.1630, 0.0767],
               [0.0199, -0.1409, 0.1248, -0.0818, -0.0686, -0.2036, -0.0940],
               [-0.0146, -0.1836, 0.1968, 0.2484, 0.0787, -0.1597, 0.0552],
               [0.0383, -0.1370, -0.0810, -0.0956, -0.1614, -0.1318, 0.0256],
               [0.0103, 0.0719, -0.0921, -0.0098, -0.0724, 0.0400, -0.0206]]],

             [[[-0.0305, 0.1150, 0.0481, 0.1001, 0.0054, 0.0362, 0.0725],
               [0.0470, 0.0807, 0.0475, -0.1376, 0.0561, 0.0357, 0.0641],
               [0.0151, 0.0226, -0.0506, -0.0674, 0.0585, 0.0075, 0.0049],
               [-0.0110, -0.0487, 0.1285, -0.0844, 0.0687, -0.1083, 0.0817],
               [0.0958, 0.0145, 0.0737, 0.0613, 0.0654, -0.0266, 0.0048],
               [0.0715, -0.0517, -0.0535, -0.1022, -0.0688, -0.0018, 0.0993],
               [0.0839, 0.0491, 0.1099, 0.0699, 0.0436, 0.0420, 0.0555]],

              [[0.0968, 0.0092, 0.0285, 0.0184, -0.0221, 0.0079, -0.0084],
               [0.0661, -0.0835, -0.1420, -0.1731, -0.0148, -0.0422, 0.0174],
               [0.0351, -0.0679, -0.0629, -0.0579, -0.0847, -0.0825, 0.0109],
               [0.0062, -0.0707, 0.1832, -0.0639, 0.0367, -0.1898, -0.0407],
               [-0.0102, -0.1799, 0.1190, 0.0844, -0.0363, -0.0805, -0.0556],
               [-0.0201, -0.0657, -0.0916, -0.0947, -0.1057, 0.0085, 0.0128],
               [0.0129, 0.0628, -0.0688, -0.0183, 0.0082, 0.0083, 0.0009]],

              [[-0.0959, -0.0078, -0.0439, 0.0163, 0.0283, -0.0126, -0.0679],
               [0.0109, -0.0424, 0.0047, -0.0185, 0.0653, 0.0338, 0.0294],
               [0.0211, 0.0809, 0.3046, 0.2893, 0.2559, 0.0490, -0.0443],
               [-0.0477, 0.0333, 0.5352, 0.3229, 0.3451, 0.0905, 0.0314],
               [-0.0337, 0.0532, 0.4912, 0.5646, 0.3947, 0.1088, 0.0136],
               [0.0172, 0.0666, 0.1248, 0.1240, 0.1455, -0.0083, -0.1051],
               [-0.0854, -0.1100, 0.0460, -0.0643, -0.0301, -0.0634, -0.0073]]]]

# regulization 2 times (0.337)
window_v6 = [[[[-0.0495, -0.0937, 0.0534, -0.0509, 0.0322, -0.0653, -0.0238],
               [0.0208, 0.0142, 0.1419, 0.0428, 0.0680, 0.0032, -0.0681],
               [-0.0057, 0.0582, 0.3407, 0.3510, 0.3658, 0.0692, 0.0366],
               [-0.0375, 0.1793, 0.4453, 0.0927, 0.4359, 0.0440, 0.0526],
               [-0.0216, -0.0092, 0.3800, 0.5426, 0.2881, 0.0304, -0.1117],
               [-0.0537, 0.0514, 0.1658, 0.0731, 0.0967, 0.0327, -0.0497],
               [-0.1064, -0.0245, -0.0392, 0.0430, -0.0768, -0.0298, -0.0900]],

              [[-0.0034, -0.0104, -0.0789, 0.0009, -0.0297, -0.0005, -0.0246],
               [-0.0952, -0.0795, -0.0716, -0.0192, -0.0558, -0.0478, -0.0180],
               [0.0166, -0.0148, 0.0559, 0.0104, 0.1515, -0.0963, -0.0382],
               [0.0440, -0.0414, 0.2343, -0.2099, 0.0744, -0.0160, -0.0744],
               [-0.0762, -0.0169, 0.1743, 0.1741, 0.1440, -0.0643, 0.0168],
               [-0.0612, -0.0364, -0.0925, -0.0169, -0.0827, -0.0093, -0.0175],
               [-0.0035, -0.0538, -0.1021, -0.0071, 0.0306, -0.0357, 0.0406]],

              [[0.1018, 0.1130, -0.0120, 0.0844, -0.0075, 0.0523, 0.0874],
               [0.0517, 0.0636, 0.0335, -0.0508, -0.0127, 0.0738, 0.0698],
               [0.1288, 0.0013, -0.0303, 0.0343, 0.1025, -0.0247, 0.0807],
               [0.0147, -0.1123, 0.1276, -0.4017, 0.1131, -0.0690, 0.0525],
               [0.0678, -0.0329, 0.0733, 0.0504, 0.0495, 0.0147, -0.0349],
               [0.0901, 0.0044, -0.0475, -0.1136, -0.0864, 0.0621, 0.1359],
               [0.1845, 0.0652, 0.0712, 0.0064, 0.0133, 0.0548, 0.0721]]],

             [[[0.0359, -0.0566, -0.0340, -0.0389, -0.0209, 0.0027, -0.0065],
               [-0.0167, -0.0189, -0.0464, -0.0621, -0.0473, -0.0177, -0.0418],
               [0.0339, -0.1075, -0.0716, -0.1135, 0.0261, -0.0971, 0.0710],
               [-0.0931, -0.1641, 0.1225, -0.0867, 0.0085, -0.1211, -0.1038],
               [-0.0330, -0.1362, 0.0733, 0.2530, 0.0461, -0.1298, 0.0540],
               [-0.0215, -0.1073, -0.0528, -0.0347, -0.1659, -0.0477, -0.0420],
               [0.0571, -0.0133, -0.0888, -0.0327, -0.0215, -0.0233, 0.0411]],

              [[0.0385, -0.0128, 0.1395, 0.1000, 0.0725, 0.0873, 0.0101],
               [-0.0188, 0.0509, 0.0392, -0.0285, 0.0668, 0.0986, 0.0377],
               [0.1255, 0.1155, 0.2818, 0.3503, 0.3249, 0.1307, 0.1025],
               [0.0087, 0.1072, 0.6485, 0.4731, 0.4777, 0.1038, 0.0692],
               [0.0762, 0.1286, 0.4759, 0.7475, 0.4030, 0.0667, 0.1311],
               [0.1079, -0.0348, 0.1538, 0.2088, 0.1898, 0.0176, 0.0066],
               [0.0044, 0.1198, 0.0183, 0.0588, 0.0964, 0.1337, 0.0308]],

              [[0.0334, 0.0503, 0.0093, -0.0756, 0.0407, 0.0369, 0.0561],
               [0.0147, -0.0483, -0.0954, -0.1758, -0.0572, -0.1206, -0.0537],
               [-0.0702, -0.0820, -0.0616, -0.1960, 0.0239, -0.1617, 0.0738],
               [0.0199, -0.1428, 0.1216, -0.0956, -0.0690, -0.2055, -0.0979],
               [-0.0133, -0.1846, 0.1981, 0.2442, 0.0789, -0.1608, 0.0520],
               [0.0434, -0.1365, -0.0801, -0.0981, -0.1615, -0.1326, 0.0227],
               [0.0159, 0.0730, -0.0919, -0.0090, -0.0709, 0.0379, -0.0239]]],

             [[[-0.0285, 0.1174, 0.0525, 0.1069, 0.0132, 0.0442, 0.0773],
               [0.0480, 0.0845, 0.0543, -0.1292, 0.0658, 0.0465, 0.0700],
               [0.0176, 0.0270, -0.0434, -0.0602, 0.0702, 0.0199, 0.0127],
               [-0.0096, -0.0478, 0.1304, -0.0933, 0.0739, -0.1014, 0.0876],
               [0.0971, 0.0156, 0.0764, 0.0635, 0.0712, -0.0201, 0.0099],
               [0.0755, -0.0482, -0.0504, -0.0991, -0.0624, 0.0066, 0.1049],
               [0.0874, 0.0506, 0.1101, 0.0710, 0.0465, 0.0487, 0.0613]],

              [[0.0996, 0.0123, 0.0316, 0.0206, -0.0201, 0.0104, -0.0055],
               [0.0683, -0.0785, -0.1360, -0.1693, -0.0110, -0.0372, 0.0212],
               [0.0375, -0.0638, -0.0572, -0.0548, -0.0784, -0.0753, 0.0174],
               [0.0063, -0.0712, 0.1838, -0.0752, 0.0392, -0.1865, -0.0353],
               [-0.0096, -0.1794, 0.1216, 0.0860, -0.0316, -0.0752, -0.0499],
               [-0.0161, -0.0623, -0.0885, -0.0920, -0.0990, 0.0167, 0.0200],
               [0.0164, 0.0635, -0.0696, -0.0174, 0.0129, 0.0148, 0.0075]],

              [[-0.0963, -0.0085, -0.0440, 0.0151, 0.0283, -0.0132, -0.0681],
               [0.0110, -0.0398, 0.0093, -0.0162, 0.0683, 0.0359, 0.0299],
               [0.0224, 0.0843, 0.3107, 0.2924, 0.2627, 0.0538, -0.0417],
               [-0.0479, 0.0328, 0.5372, 0.3130, 0.3493, 0.0920, 0.0330],
               [-0.0332, 0.0536, 0.4955, 0.5677, 0.4016, 0.1132, 0.0172],
               [0.0198, 0.0689, 0.1282, 0.1271, 0.1532, -0.0015, -0.1003],
               [-0.0836, -0.1105, 0.0451, -0.0638, -0.0254, -0.0586, -0.0032]]]]

# 3to1to3 sigmoid
window_v7 = [[[[0.0257, -0.0551, 0.0829, -0.0198, 0.0140, -0.0572, 0.0380],
               [0.0318, -0.0446, 0.0731, -0.0270, -0.0702, -0.0542, -0.0130],
               [0.0176, -0.0574, -0.0070, 0.0034, 0.0661, -0.0071, 0.0696],
               [-0.0445, 0.0384, -0.0651, -0.0159, 0.0248, 0.0021, 0.0761],
               [0.0380, -0.0703, -0.0161, 0.0609, -0.0405, 0.0153, -0.0822],
               [0.0200, 0.0359, 0.0495, -0.0797, -0.0256, 0.0320, 0.0014],
               [-0.0014, 0.0352, -0.0070, 0.0737, -0.0668, 0.0248, 0.0078]],

              [[0.0191, 0.0126, -0.0530, 0.0458, -0.0366, 0.0084, 0.0003],
               [-0.0876, -0.0639, -0.0126, 0.0676, -0.0670, -0.0184, 0.0607],
               [0.0702, 0.0320, -0.0133, -0.0223, 0.1231, 0.0148, 0.0503],
               [0.0724, 0.0065, 0.0657, 0.0199, 0.0175, 0.1871, 0.0123],
               [-0.0300, 0.0627, 0.0556, 0.0073, 0.0785, 0.0680, 0.0483],
               [-0.0493, 0.0163, -0.0527, 0.0036, -0.0787, 0.0346, -0.0172],
               [-0.0287, -0.0340, -0.0595, 0.0422, 0.0310, -0.0288, 0.0309]],

              [[0.0147, 0.0436, -0.0774, 0.0542, -0.1007, -0.0300, 0.0016],
               [-0.0498, 0.0149, 0.0453, 0.0133, -0.0703, 0.0333, 0.0398],
               [0.0603, -0.0062, -0.0880, 0.0570, 0.0841, 0.0440, 0.0701],
               [-0.0565, -0.0805, 0.0406, -0.0736, 0.1339, 0.1304, 0.0765],
               [0.0073, 0.0085, -0.0095, -0.0294, 0.0194, 0.1280, -0.0691],
               [0.0029, 0.0047, -0.0321, -0.0849, -0.1010, 0.0659, 0.0611],
               [0.0458, -0.0028, 0.0340, -0.0079, -0.0633, -0.0173, -0.0278]]]]

# regulization with bias sigmoid
window_v8 = [[[[0.0572, -0.0397, 0.1011, 0.0121, 0.0564, -0.0302, 0.0435],
               [0.0567, -0.0397, 0.0845, 0.0064, -0.0114, -0.0047, 0.0035],
               [0.0326, -0.0435, 0.0267, 0.0392, 0.0820, -0.0053, 0.0933],
               [-0.0275, 0.0731, -0.0021, 0.0391, 0.0213, -0.0383, 0.0962],
               [0.0492, -0.0373, 0.0482, 0.1294, -0.0162, 0.0095, -0.0583],
               [0.0364, 0.0565, 0.0987, -0.0158, 0.0180, 0.0649, 0.0225],
               [0.0301, 0.0300, -0.0096, 0.1008, -0.0441, 0.0298, -0.0006]],

              [[0.0243, 0.0050, -0.0536, 0.0581, -0.0118, 0.0112, -0.0306],
               [-0.0846, -0.0786, -0.0237, 0.0793, -0.0221, 0.0004, 0.0212],
               [0.0665, 0.0240, -0.0113, -0.0220, 0.0905, -0.0556, 0.0090],
               [0.0694, 0.0170, 0.0962, 0.0339, -0.0516, 0.0477, -0.0256],
               [-0.0450, 0.0643, 0.0855, 0.0505, 0.0756, 0.0259, 0.0537],
               [-0.0672, -0.0046, -0.0396, 0.0531, -0.0376, 0.0616, -0.0084],
               [-0.0218, -0.0767, -0.0925, 0.0585, 0.0553, -0.0304, 0.0071]],

              [[0.0275, 0.0421, -0.0742, 0.0657, -0.0782, -0.0244, -0.0178],
               [-0.0415, 0.0013, 0.0319, 0.0193, -0.0311, 0.0538, 0.0130],
               [0.0576, -0.0192, -0.0956, 0.0472, 0.0415, -0.0320, 0.0359],
               [-0.0597, -0.0787, 0.0560, -0.0796, 0.0482, -0.0176, 0.0291],
               [-0.0042, 0.0077, 0.0068, -0.0102, -0.0094, 0.0638, -0.0869],
               [-0.0095, -0.0114, -0.0234, -0.0530, -0.0828, 0.0690, 0.0508],
               [0.0611, -0.0331, 0.0077, 0.0035, -0.0491, -0.0293, -0.0640]]],

             [[[0.0433, -0.0565, -0.0357, -0.0185, -0.0325, -0.0294, -0.0673],
               [-0.0004, -0.0060, 0.0274, 0.0753, 0.0339, 0.0314, -0.0415],
               [0.0512, -0.0417, -0.0551, -0.0298, 0.0741, 0.0004, 0.0556],
               [-0.0494, -0.0543, -0.0240, -0.0158, -0.0010, 0.0151, -0.0767],
               [0.0124, -0.0116, -0.0415, 0.0896, 0.0128, -0.0296, 0.0580],
               [-0.0105, -0.0204, 0.0339, 0.0548, -0.0819, -0.0012, -0.0440],
               [0.0471, -0.0065, -0.0469, 0.0053, -0.0018, -0.0319, 0.0423]],

              [[0.0367, -0.0483, 0.0733, 0.0497, 0.0171, 0.0513, -0.0387],
               [-0.0542, -0.0360, -0.0389, -0.0603, 0.0108, 0.0743, 0.0119],
               [0.0648, 0.0196, 0.0321, 0.1201, 0.1070, 0.0736, 0.0214],
               [-0.0494, -0.0030, 0.1066, 0.0900, 0.0880, 0.0332, 0.0108],
               [0.0219, 0.0532, -0.0011, 0.1317, 0.0182, -0.0266, 0.0522],
               [0.0511, -0.0655, 0.0515, 0.0667, 0.0844, -0.0474, -0.0482],
               [-0.0384, 0.0672, -0.0317, -0.0176, 0.0244, 0.0772, 0.0119]],

              [[0.0161, 0.0432, -0.0010, -0.0582, 0.0383, 0.0154, -0.0241],
               [0.0188, -0.0174, -0.0038, -0.0161, 0.0452, -0.0552, -0.0684],
               [-0.0529, 0.0139, -0.0050, -0.0738, 0.0933, -0.0461, 0.0603],
               [0.0610, -0.0125, 0.0128, 0.0113, -0.0601, -0.0364, -0.0429],
               [0.0036, -0.0701, 0.0787, 0.0735, 0.0469, -0.0386, 0.0737],
               [0.0156, -0.0524, 0.0163, 0.0010, -0.0599, -0.0630, 0.0167],
               [-0.0477, 0.0597, -0.0556, 0.0177, -0.0559, 0.0309, -0.0444]]],

             [[[-0.0687, 0.0719, 0.0031, 0.0632, -0.0579, -0.0123, 0.0336],
               [-0.0150, 0.0209, 0.0278, -0.1000, 0.0463, 0.0165, 0.0286],
               [-0.0610, 0.0227, -0.0789, -0.0492, 0.0505, 0.0135, -0.0784],
               [-0.0687, 0.0032, 0.0297, 0.0779, 0.0579, -0.0270, 0.0395],
               [0.0593, 0.0506, -0.0089, -0.0339, 0.0746, 0.0529, -0.0096],
               [0.0052, -0.0840, -0.0609, -0.0769, -0.0617, -0.0162, 0.0558],
               [0.0169, -0.0038, 0.0770, 0.0329, -0.0422, -0.0320, 0.0236]],

              [[0.0509, -0.0129, 0.0349, 0.0536, -0.0106, -0.0056, -0.0719],
               [0.0334, -0.0922, -0.0931, -0.0584, 0.0542, -0.0075, -0.0098],
               [0.0389, 0.0153, -0.0309, -0.0048, -0.0480, -0.0133, -0.0256],
               [0.0277, 0.0476, 0.0759, 0.0614, 0.0126, -0.0596, -0.0273],
               [0.0080, -0.0861, 0.0394, -0.0524, -0.0296, 0.0448, -0.0275],
               [-0.0433, -0.0230, -0.0221, 0.0012, -0.0205, 0.0647, 0.0082],
               [-0.0232, 0.0778, -0.0093, 0.0455, 0.0234, 0.0111, 0.0032]],

              [[-0.0536, 0.0215, -0.0312, 0.0506, 0.0609, 0.0374, -0.0390],
               [0.0511, -0.0479, -0.0358, -0.0287, 0.0390, 0.0594, 0.0595],
               [0.0551, 0.0798, 0.1128, 0.0605, 0.0586, 0.0295, -0.0563],
               [-0.0204, 0.0097, 0.1135, 0.0665, 0.0050, 0.0888, 0.0542],
               [-0.0129, 0.0090, 0.1095, 0.0546, 0.0908, 0.0934, 0.0419],
               [0.0310, 0.0523, 0.0252, 0.0005, 0.0458, -0.0274, -0.0865],
               [-0.0398, -0.0650, 0.0729, -0.0622, -0.0619, -0.0524, 0.0590]]]]
window_v8_bias = [[[-0.0023, -0.0062, -0.0374]]]  # [-0.0023, -0.0062, -0.0374]

# 1 to 3 sigmoid
window_v9 = [[[[0.1076, -0.0839, 0.1442, -0.0144, 0.0646, -0.0761, 0.0611],
               [0.0930, -0.1059, 0.0893, -0.0423, -0.0821, -0.0546, 0.0007],
               [0.0409, -0.1313, -0.0381, -0.0004, 0.0776, -0.0549, 0.1683],
               [-0.0729, 0.0808, -0.0620, 0.0191, -0.0180, -0.1003, 0.1659],
               [0.0642, -0.0917, 0.0529, 0.1802, -0.0811, -0.0115, -0.1121],
               [0.0529, 0.0778, 0.1338, -0.0838, -0.0282, 0.0762, 0.0228],
               [0.0446, 0.0372, -0.0476, 0.1287, -0.1347, 0.0047, -0.0237]]],

             [[[0.0707, 0.0164, -0.0934, 0.0964, -0.0273, 0.0162, -0.0590],
               [-0.1315, -0.1527, -0.0614, 0.1308, -0.0478, -0.0049, 0.0478],
               [0.1170, 0.0035, -0.0750, -0.0390, 0.1842, -0.0552, 0.0694],
               [0.1128, 0.0076, 0.1565, 0.1051, -0.0259, 0.1618, 0.0080],
               [-0.0756, 0.1282, 0.1818, 0.1325, 0.1815, 0.1012, 0.1034],
               [-0.0860, 0.0228, -0.0422, 0.1022, -0.0618, 0.1157, -0.0289],
               [0.0012, -0.0909, -0.1261, 0.1173, 0.0826, -0.0785, -0.0030]]],

             [[[0.0773, 0.0983, -0.1090, 0.1299, -0.1230, -0.0304, -0.0230],
               [-0.0471, 0.0164, 0.0730, 0.0715, -0.0214, 0.1320, 0.0699],
               [0.1299, -0.0308, -0.1675, 0.1261, 0.1449, 0.0378, 0.1582],
               [-0.0817, -0.1261, 0.1055, -0.0758, 0.1823, 0.0906, 0.1494],
               [0.0082, 0.0324, 0.0375, 0.0194, 0.0538, 0.2057, -0.0848],
               [0.0075, 0.0023, -0.0272, -0.0828, -0.1151, 0.1725, 0.1255],
               [0.1231, -0.0314, 0.0358, 0.0258, -0.0762, -0.0353, -0.0897]]]]

# 3 to 1 to 3 no sigmoid
window_v10 = [[[[0.0187, -0.0631, 0.0752, -0.0150, 0.0356, -0.0351, 0.0305],
                [0.0298, -0.0401, 0.0660, -0.0514, -0.0869, -0.0389, -0.0180],
                [0.0164, -0.0453, -0.0118, -0.0346, 0.0255, -0.0238, 0.0428],
                [-0.0395, 0.0536, -0.0537, -0.0040, 0.0415, -0.0044, 0.0425],
                [0.0406, -0.0688, -0.0045, 0.0977, 0.0234, 0.0479, -0.0957],
                [0.0176, 0.0227, 0.0285, -0.0899, -0.0079, 0.0560, -0.0007],
                [-0.0029, 0.0346, -0.0176, 0.0536, -0.0685, 0.0436, 0.0141]],

               [[0.0187, 0.0133, -0.0478, 0.0591, -0.0137, 0.0331, -0.0085],
                [-0.0907, -0.0547, -0.0076, 0.0485, -0.0786, 0.0166, 0.0646],
                [0.0661, 0.0433, -0.0182, -0.0613, 0.0829, 0.0104, 0.0149],
                [0.0683, 0.0155, 0.0737, 0.0469, 0.0878, 0.1955, -0.0643],
                [-0.0301, 0.0676, 0.0685, 0.0639, 0.2060, 0.1250, 0.0087],
                [-0.0467, 0.0088, -0.0800, -0.0195, -0.0755, 0.0480, -0.0311],
                [-0.0206, -0.0237, -0.0693, 0.0065, 0.0041, -0.0221, 0.0292]],

               [[0.0179, 0.0436, -0.0694, 0.0720, -0.0733, -0.0017, 0.0032],
                [-0.0509, 0.0192, 0.0521, 0.0053, -0.0714, 0.0632, 0.0476],
                [0.0570, 0.0011, -0.0862, 0.0343, 0.0509, 0.0231, 0.0300],
                [-0.0599, -0.0711, 0.0568, -0.0369, 0.1995, 0.1157, -0.0150],
                [-0.0017, 0.0080, 0.0084, 0.0353, 0.1412, 0.1746, -0.1193],
                [-0.0072, -0.0087, -0.0505, -0.0891, -0.0808, 0.0865, 0.0465],
                [0.0433, -0.0030, 0.0249, -0.0327, -0.0813, -0.0050, -0.0309]]]]
window_v10_back = [[[[0.1044, -0.0743, -0.0344, 0.0157, -0.0265, -0.0571, -0.1110],
                     [0.0199, -0.0111, 0.0589, 0.1894, 0.1181, 0.0747, -0.0537],
                     [0.1071, -0.1012, -0.1268, -0.0112, 0.2072, 0.0604, 0.1281],
                     [-0.0563, -0.1083, -0.0930, -0.0414, 0.0178, 0.0498, -0.1257],
                     [0.0475, 0.0038, -0.0969, 0.1208, 0.0049, -0.0466, 0.1218],
                     [-0.0116, 0.0048, 0.0802, 0.0805, -0.1570, 0.0130, -0.0394],
                     [0.0846, 0.0271, -0.0285, 0.0259, -0.0059, -0.0543, 0.0805]]],

                   [[[0.0673, -0.0846, 0.1190, 0.0776, -0.0294, -0.0166, -0.1127],
                     [-0.0939, -0.0816, -0.0831, -0.0811, 0.0272, 0.0762, -0.0154],
                     [0.1054, -0.0218, -0.0152, 0.2270, 0.2688, 0.1597, 0.0248],
                     [-0.0926, -0.0515, 0.1028, 0.1209, 0.1342, 0.0293, -0.0354],
                     [0.0200, 0.0763, -0.0717, 0.1436, -0.0544, -0.0933, 0.0616],
                     [0.0591, -0.1122, 0.0619, 0.0452, 0.0812, -0.0937, -0.0693],
                     [-0.0747, 0.1250, -0.0485, -0.0555, 0.0013, 0.1014, -0.0044]]],

                   [[[0.0301, 0.1019, 0.0283, -0.0690, 0.0613, -0.0081, -0.0370],
                     [0.0447, -0.0026, 0.0356, 0.0390, 0.1247, -0.0849, -0.1003],
                     [-0.0736, 0.0288, 0.0041, -0.0596, 0.2441, -0.0179, 0.1410],
                     [0.1258, -0.0115, 0.0191, 0.0463, -0.0882, -0.0569, -0.0829],
                     [0.0074, -0.0905, 0.1415, 0.1201, 0.0566, -0.0742, 0.1368],
                     [0.0165, -0.0569, 0.0568, 0.0072, -0.1067, -0.0788, 0.0758],
                     [-0.0676, 0.1306, -0.0650, 0.0570, -0.0797, 0.0710, -0.0680]]]]

# input ssim third
window_v11 = [[[[0.1529, 0.1706, 0.2099, 0.2075, 0.1990, 0.1583, 0.1460],
                [0.1528, 0.1911, 0.2572, 0.2729, 0.2533, 0.1851, 0.1404],
                [0.1833, 0.2557, 0.3831, 0.4508, 0.3915, 0.2566, 0.1742],
                [0.1947, 0.2923, 0.5270, 1.6679, 0.5326, 0.2992, 0.1931],
                [0.1796, 0.2614, 0.4558, 0.5726, 0.4541, 0.2679, 0.1826],
                [0.1443, 0.1833, 0.3015, 0.3517, 0.2945, 0.2016, 0.1559],
                [0.1480, 0.1557, 0.2127, 0.2325, 0.1985, 0.1645, 0.1662]],

               [[-0.0924, -0.1324, -0.1273, -0.1255, -0.1171, -0.1123, -0.0624],
                [-0.1323, -0.1788, -0.1705, -0.1665, -0.1644, -0.1604, -0.1108],
                [-0.1340, -0.1724, -0.1245, -0.0784, -0.1128, -0.1506, -0.1081],
                [-0.1305, -0.1582, -0.0210, 1.1082, -0.0133, -0.1365, -0.1016],
                [-0.1424, -0.1835, -0.0940, -0.0121, -0.0891, -0.1618, -0.1134],
                [-0.1468, -0.2002, -0.1664, -0.1460, -0.1636, -0.1664, -0.1102],
                [-0.0863, -0.1360, -0.1275, -0.1214, -0.1283, -0.1091, -0.0492]],

               [[-0.0493, -0.0916, -0.0956, -0.1029, -0.0989, -0.0905, -0.0415],
                [-0.0924, -0.1598, -0.1838, -0.2005, -0.1903, -0.1599, -0.0917],
                [-0.1078, -0.1853, -0.1966, -0.1822, -0.1940, -0.1814, -0.0987],
                [-0.1159, -0.1991, -0.1398, 0.9532, -0.1306, -0.1848, -0.0965],
                [-0.1295, -0.2231, -0.2003, -0.1457, -0.1888, -0.1989, -0.1036],
                [-0.1257, -0.2197, -0.2279, -0.2197, -0.2171, -0.1811, -0.0941],
                [-0.0655, -0.1360, -0.1465, -0.1426, -0.1423, -0.1077, -0.0352]]],

              [[[-0.0221, -0.0264, -0.0409, -0.0640, -0.0518, -0.0207, -0.0024],
                [-0.0386, -0.0740, -0.1116, -0.1258, -0.1199, -0.0681, -0.0192],
                [-0.0547, -0.1192, -0.1236, -0.0605, -0.1231, -0.1099, -0.0296],
                [-0.0465, -0.1011, -0.0239, 1.1849, -0.0212, -0.0997, -0.0274],
                [-0.0545, -0.1175, -0.1154, -0.0117, -0.1189, -0.1201, -0.0423],
                [-0.0377, -0.0665, -0.0890, -0.0736, -0.1043, -0.0766, -0.0301],
                [-0.0237, -0.0268, -0.0306, -0.0339, -0.0485, -0.0395, -0.0167]],

               [[0.0310, 0.0464, 0.0444, 0.0248, 0.0318, 0.0460, 0.0368],
                [0.0522, 0.0556, 0.0383, 0.0205, 0.0215, 0.0508, 0.0572],
                [0.0539, 0.0393, 0.0580, 0.1121, 0.0486, 0.0410, 0.0710],
                [0.0593, 0.0594, 0.1626, 1.3440, 0.1594, 0.0574, 0.0762],
                [0.0522, 0.0426, 0.0755, 0.1832, 0.0758, 0.0421, 0.0643],
                [0.0489, 0.0675, 0.0705, 0.0901, 0.0616, 0.0636, 0.0584],
                [0.0262, 0.0642, 0.0841, 0.0845, 0.0739, 0.0617, 0.0398]],

               [[0.0105, 0.0044, -0.0214, -0.0504, -0.0336, 0.0069, 0.0256],
                [0.0026, -0.0469, -0.1151, -0.1511, -0.1292, -0.0465, 0.0191],
                [-0.0302, -0.1292, -0.1974, -0.1801, -0.2079, -0.1298, -0.0076],
                [-0.0470, -0.1540, -0.1647, 0.9728, -0.1701, -0.1602, -0.0277],
                [-0.0431, -0.1558, -0.2313, -0.1716, -0.2314, -0.1579, -0.0284],
                [-0.0047, -0.0657, -0.1445, -0.1531, -0.1521, -0.0731, 0.0055],
                [0.0093, -0.0020, -0.0283, -0.0407, -0.0400, -0.0102, 0.0199]]],

              [[[0.0523, 0.0445, 0.0378, 0.0265, 0.0277, 0.0373, 0.0713],
                [0.0316, -0.0161, -0.0717, -0.0937, -0.0736, -0.0231, 0.0449],
                [0.0356, -0.0542, -0.1073, -0.0848, -0.1053, -0.0678, 0.0272],
                [0.0432, -0.0546, -0.0518, 1.0905, -0.0383, -0.0684, 0.0294],
                [0.0320, -0.0623, -0.1175, -0.0674, -0.1050, -0.0756, 0.0198],
                [0.0374, -0.0220, -0.0758, -0.0743, -0.0705, -0.0319, 0.0349],
                [0.0764, 0.0528, 0.0349, 0.0310, 0.0266, 0.0408, 0.0809]],

               [[-0.0005, -0.0267, -0.0475, -0.0598, -0.0493, -0.0283, 0.0151],
                [-0.0336, -0.0914, -0.1533, -0.1769, -0.1476, -0.0881, -0.0151],
                [-0.0439, -0.1334, -0.1806, -0.1554, -0.1681, -0.1295, -0.0347],
                [-0.0539, -0.1477, -0.1301, 1.0144, -0.1024, -0.1359, -0.0441],
                [-0.0689, -0.1631, -0.2026, -0.1410, -0.1717, -0.1501, -0.0607],
                [-0.0587, -0.1265, -0.1776, -0.1712, -0.1552, -0.1170, -0.0538],
                [-0.0018, -0.0348, -0.0556, -0.0585, -0.0542, -0.0403, -0.0059]],

               [[-0.0413, -0.0337, -0.0177, -0.0122, -0.0159, -0.0358, -0.0323],
                [-0.0517, -0.0308, 0.0006, 0.0227, 0.0161, -0.0186, -0.0363],
                [-0.0264, 0.0198, 0.1264, 0.2232, 0.1533, 0.0381, -0.0160],
                [-0.0113, 0.0633, 0.2694, 1.4956, 0.3148, 0.0914, 0.0018],
                [-0.0300, 0.0264, 0.1566, 0.3014, 0.2033, 0.0553, -0.0173],
                [-0.0461, -0.0163, 0.0475, 0.1128, 0.0795, 0.0028, -0.0406],
                [-0.0250, -0.0152, 0.0196, 0.0502, 0.0292, -0.0150, -0.0301]]]]

# input ssim three 130
window_v12 = [[[[-0.0903, -0.0719, -0.0157, -0.0638, 0.0274, -0.0395, -0.0933],
                [-0.0405, 0.0705, 0.2211, 0.1500, 0.2799, 0.1114, -0.0429],
                [0.0005, 0.2515, 0.5213, 0.2205, 0.5497, 0.2819, 0.0202],
                [-0.1061, 0.1335, 0.2762, -0.0601, 0.2662, 0.1377, -0.0983],
                [-0.0090, 0.2561, 0.5609, 0.2678, 0.5554, 0.2672, 0.0109],
                [-0.0458, 0.1008, 0.3036, 0.2130, 0.3009, 0.1228, -0.0146],
                [-0.0580, -0.0318, 0.0464, -0.0306, 0.0497, -0.0045, -0.0304]],

               [[-0.0808, -0.1253, -0.1222, -0.1804, -0.0961, -0.1228, -0.1089],
                [-0.0862, -0.0816, -0.0251, -0.1138, 0.0122, -0.0749, -0.1123],
                [-0.0875, 0.0063, 0.1440, -0.1514, 0.1532, 0.0073, -0.0902],
                [-0.2025, -0.1382, -0.1371, -0.3455, -0.1619, -0.1588, -0.2113],
                [-0.1244, -0.0359, 0.1007, -0.2127, 0.0778, -0.0523, -0.1215],
                [-0.1309, -0.1125, -0.0359, -0.1585, -0.0534, -0.1132, -0.1110],
                [-0.0782, -0.1239, -0.1188, -0.2099, -0.1201, -0.1077, -0.0540]],

               [[0.0411, 0.0124, 0.0174, -0.0350, 0.0289, -0.0004, 0.0085],
                [0.0333, 0.0357, 0.0734, -0.0183, 0.0959, 0.0263, 0.0007],
                [0.0331, 0.0984, 0.1932, -0.0900, 0.1857, 0.0767, 0.0146],
                [-0.0657, -0.0411, -0.0728, -0.1556, -0.1121, -0.0835, -0.0971],
                [0.0058, 0.0578, 0.1409, -0.1624, 0.1079, 0.0225, -0.0141],
                [0.0010, 0.0007, 0.0460, -0.0796, 0.0226, -0.0122, 0.0024],
                [0.0444, -0.0034, -0.0011, -0.0775, -0.0036, 0.0074, 0.0574]]],

              [[[-0.0409, -0.0509, -0.0503, -0.1018, -0.0887, -0.0516, 0.0035],
                [-0.0708, -0.0949, -0.0944, -0.1298, -0.1387, -0.1198, -0.0351],
                [-0.0836, -0.1045, -0.0022, 0.0256, -0.0702, -0.1459, -0.0487],
                [-0.0932, -0.1041, 0.0794, 1.1354, -0.0080, -0.1435, -0.0422],
                [-0.1188, -0.1758, -0.0857, -0.0402, -0.1396, -0.1860, -0.0592],
                [-0.0878, -0.1351, -0.1218, -0.1357, -0.1569, -0.1296, -0.0407],
                [-0.0377, -0.0551, -0.0268, -0.0560, -0.0551, -0.0565, -0.0198]],

               [[-0.0168, 0.0223, 0.0471, -0.0095, 0.0002, 0.0076, 0.0198],
                [0.0182, 0.0737, 0.1094, 0.0647, 0.0547, 0.0349, 0.0536],
                [0.0394, 0.1047, 0.2338, 0.2345, 0.1583, 0.0526, 0.0716],
                [0.0365, 0.1018, 0.2897, 1.2583, 0.1998, 0.0516, 0.0756],
                [0.0365, 0.0646, 0.1801, 0.1996, 0.1214, 0.0403, 0.0819],
                [0.0352, 0.0718, 0.1179, 0.0904, 0.0698, 0.0596, 0.0713],
                [0.0239, 0.0753, 0.1310, 0.0933, 0.0957, 0.0657, 0.0386]],

               [[-0.0167, -0.0050, -0.0063, -0.0666, -0.0531, -0.0148, 0.0381],
                [-0.0230, -0.0325, -0.0607, -0.1255, -0.1197, -0.0721, 0.0308],
                [-0.0411, -0.0818, -0.0633, -0.0986, -0.1515, -0.1489, -0.0004],
                [-0.0603, -0.1275, -0.0766, 0.8871, -0.1831, -0.2004, -0.0232],
                [-0.0592, -0.1636, -0.1892, -0.2217, -0.2632, -0.2058, -0.0195],
                [-0.0209, -0.0854, -0.1385, -0.2000, -0.1957, -0.1079, 0.0159],
                [0.0135, 0.0066, 0.0142, -0.0300, -0.0256, -0.0057, 0.0384]]],

              [[[0.0310, 0.0206, 0.0163, -0.0670, 0.0192, 0.0243, 0.0412],
                [0.0036, -0.0293, -0.0299, -0.1703, -0.0426, -0.0412, 0.0180],
                [0.0057, 0.0030, 0.0774, -0.1588, 0.0152, -0.0585, 0.0212],
                [-0.0756, -0.1019, -0.0665, 0.2270, -0.1545, -0.1837, -0.0588],
                [-0.0083, -0.0242, 0.0483, -0.1596, -0.0074, -0.0811, 0.0122],
                [-0.0055, -0.0506, -0.0339, -0.1492, -0.0417, -0.0590, 0.0200],
                [0.0506, 0.0082, 0.0205, -0.0644, 0.0060, -0.0065, 0.0550]],

               [[0.0044, -0.0090, -0.0199, -0.1043, -0.0169, -0.0143, 0.0079],
                [-0.0338, -0.0625, -0.0630, -0.1949, -0.0684, -0.0763, -0.0209],
                [-0.0367, -0.0338, 0.0555, -0.1654, 0.0089, -0.0851, -0.0238],
                [-0.1215, -0.1432, -0.0975, 0.1810, -0.1626, -0.2090, -0.1091],
                [-0.0624, -0.0794, 0.0055, -0.1892, -0.0322, -0.1226, -0.0431],
                [-0.0794, -0.1288, -0.1088, -0.2132, -0.1072, -0.1280, -0.0458],
                [-0.0192, -0.0636, -0.0531, -0.1345, -0.0594, -0.0667, 0.0006]],

               [[-0.0635, -0.0461, -0.0179, -0.0827, -0.0131, -0.0502, -0.0604],
                [-0.0802, -0.0199, 0.0865, 0.0122, 0.1037, -0.0077, -0.0495],
                [-0.0351, 0.1270, 0.3990, 0.2799, 0.3870, 0.1125, 0.0021],
                [-0.0799, 0.0984, 0.3781, 0.7947, 0.3470, 0.0681, -0.0474],
                [-0.0159, 0.1531, 0.4448, 0.3612, 0.4309, 0.1333, 0.0138],
                [-0.0560, 0.0176, 0.1752, 0.1406, 0.1848, 0.0240, -0.0251],
                [-0.0375, -0.0312, 0.0455, 0.0023, 0.0391, -0.0381, -0.0278]]]]

# ssim edge *2
window_v13 = [[[[0.0870, 0.1114, 0.1110, 0.0226, 0.1094, 0.1016, 0.0797],
                [0.1173, 0.1468, 0.1231, -0.0026, 0.1495, 0.1532, 0.1226],
                [0.1396, 0.1324, -0.0029, -0.3120, 0.0717, 0.1639, 0.1309],
                [0.0458, -0.0147, -0.3893, -0.3613, -0.2993, 0.0206, 0.0339],
                [0.1317, 0.1552, -0.0158, -0.3840, 0.0212, 0.1618, 0.1315],
                [0.0950, 0.1590, 0.1450, 0.0141, 0.1644, 0.1707, 0.1037],
                [0.0370, 0.0949, 0.1264, 0.0479, 0.1255, 0.1120, 0.0621]],

               [[-0.0924, -0.0958, -0.0795, -0.1327, -0.0789, -0.1032, -0.0971],
                [-0.0939, -0.1035, -0.1113, -0.1897, -0.0813, -0.1024, -0.0969],
                [-0.0423, -0.0878, -0.1691, -0.3868, -0.0806, -0.0614, -0.0709],
                [-0.0732, -0.1669, -0.4595, -0.3386, -0.3549, -0.1417, -0.1209],
                [-0.0079, -0.0370, -0.1800, -0.4839, -0.1390, -0.0432, -0.0437],
                [-0.0514, -0.0378, -0.0602, -0.1579, -0.0441, -0.0479, -0.0761],
                [-0.0687, -0.0400, -0.0045, -0.0617, -0.0272, -0.0628, -0.0887]],

               [[0.2342, 0.2019, 0.1727, 0.0861, 0.1339, 0.1392, 0.1728],
                [0.2083, 0.1335, 0.0471, -0.0801, 0.0354, 0.0768, 0.1472],
                [0.2252, 0.0772, -0.1176, -0.3879, -0.0642, 0.0507, 0.1431],
                [0.1717, -0.0451, -0.4618, -0.3638, -0.3842, -0.0602, 0.0798],
                [0.2265, 0.0786, -0.1820, -0.5334, -0.1541, 0.0484, 0.1610],
                [0.2041, 0.1281, 0.0199, -0.1184, 0.0276, 0.1051, 0.1614],
                [0.2081, 0.1849, 0.1686, 0.0964, 0.1499, 0.1612, 0.1841]]],

              [[[0.0699, -0.0275, -0.0441, -0.0610, -0.0037, -0.0243, 0.0693],
                [-0.0445, -0.1778, -0.1454, -0.0315, -0.0179, -0.1297, -0.0116],
                [-0.0258, -0.2126, 0.0682, 0.5565, 0.4912, -0.0355, -0.0191],
                [-0.0707, -0.2788, 0.0788, 1.4853, 0.6230, -0.0092, -0.0436],
                [-0.0658, -0.2772, -0.1473, 0.1228, 0.1381, -0.1735, -0.0776],
                [-0.0300, -0.1735, -0.1999, -0.1791, -0.1192, -0.1753, -0.0643],
                [0.0892, -0.0218, -0.0025, -0.0438, -0.0085, -0.0311, 0.0633]],

               [[-0.0158, -0.1135, -0.1740, -0.2377, -0.1645, -0.1646, -0.1078],
                [-0.0834, -0.2093, -0.2446, -0.1882, -0.1404, -0.2194, -0.1373],
                [-0.0534, -0.2463, -0.0570, 0.3462, 0.3387, -0.1480, -0.1624],
                [-0.0997, -0.3442, -0.0984, 1.1579, 0.4191, -0.1667, -0.2131],
                [-0.0524, -0.2851, -0.2556, -0.0759, -0.0059, -0.2656, -0.1648],
                [-0.0126, -0.1500, -0.2490, -0.3012, -0.2055, -0.2050, -0.0938],
                [0.0615, -0.0115, -0.0191, -0.1080, -0.0521, -0.0530, 0.0100]],

               [[0.1798, 0.0858, 0.0589, 0.0394, 0.1144, 0.1175, 0.1899],
                [0.0624, -0.0793, -0.0973, -0.0033, 0.0549, 0.0027, 0.1203],
                [0.0419, -0.1885, -0.0014, 0.4387, 0.4486, 0.0279, 0.0695],
                [-0.0234, -0.3224, -0.0834, 1.2614, 0.4881, -0.0185, 0.0021],
                [0.0052, -0.2973, -0.2935, -0.0816, 0.0052, -0.1739, -0.0002],
                [0.0525, -0.1589, -0.2882, -0.3160, -0.1994, -0.1436, 0.0338],
                [0.1487, 0.0132, -0.0220, -0.0821, -0.0158, 0.0120, 0.1272]]],

              [[[0.1554, 0.1770, 0.1517, 0.0824, 0.1608, 0.1743, 0.1351],
                [0.2180, 0.1566, -0.0017, -0.1411, 0.0223, 0.1470, 0.1937],
                [0.2313, 0.0268, -0.2228, -0.3876, -0.1262, 0.0327, 0.1742],
                [0.1662, -0.1339, -0.5115, 0.0446, -0.3664, -0.1153, 0.0991],
                [0.2277, 0.0220, -0.3060, -0.5652, -0.2483, 0.0019, 0.1781],
                [0.2517, 0.1729, 0.0040, -0.1779, 0.0070, 0.1597, 0.2125],
                [0.2157, 0.1992, 0.1753, 0.0926, 0.1811, 0.2109, 0.1785]],

               [[-0.0490, -0.0302, -0.0555, -0.1344, -0.0640, -0.0507, -0.0905],
                [-0.0075, -0.0470, -0.1900, -0.3274, -0.1646, -0.0562, -0.0355],
                [-0.0127, -0.1813, -0.4061, -0.5547, -0.2823, -0.1599, -0.0668],
                [-0.0905, -0.3636, -0.7177, -0.1542, -0.5322, -0.3229, -0.1603],
                [-0.0235, -0.2036, -0.5061, -0.7544, -0.4299, -0.2151, -0.0774],
                [-0.0077, -0.0653, -0.2153, -0.3955, -0.2148, -0.0854, -0.0510],
                [-0.0379, -0.0391, -0.0511, -0.1365, -0.0595, -0.0522, -0.0934]],

               [[-0.0575, 0.0290, 0.0718, 0.0232, 0.0832, 0.0341, -0.0798],
                [0.0546, 0.1601, 0.1651, 0.0934, 0.2165, 0.1861, 0.0533],
                [0.1086, 0.1747, 0.1663, 0.0905, 0.3126, 0.2450, 0.1057],
                [0.0542, 0.0701, -0.0361, 0.5859, 0.1698, 0.1702, 0.0542],
                [0.1190, 0.2082, 0.1515, -0.0071, 0.2544, 0.2525, 0.1247],
                [0.0788, 0.2150, 0.2401, 0.1308, 0.2580, 0.2219, 0.0673],
                [-0.0397, 0.0659, 0.1405, 0.0841, 0.1338, 0.0493, -0.0944]]]]

# ssim three again
window_v14 = [[[[-0.2726, -0.1972, -0.0997, -0.1971, -0.0870, -0.1841, -0.2996],
                [-0.1847, -0.0033, 0.2411, 0.1389, 0.2750, 0.0464, -0.1964],
                [-0.1147, 0.1679, 0.5308, 0.1821, 0.6021, 0.2456, -0.1225],
                [-0.2574, -0.0068, 0.1053, -0.8525, 0.1858, 0.0728, -0.2638],
                [-0.1083, 0.1840, 0.4687, 0.0446, 0.5272, 0.2382, -0.1124],
                [-0.1656, -0.0105, 0.1899, 0.0590, 0.2222, 0.0170, -0.2002],
                [-0.1969, -0.1753, -0.0796, -0.1840, -0.0689, -0.1621, -0.2494]],

               [[-0.1602, -0.1039, -0.0176, -0.0856, 0.0039, -0.0726, -0.1536],
                [-0.0923, 0.0348, 0.2366, 0.1703, 0.2698, 0.0873, -0.0800],
                [-0.0294, 0.1735, 0.4822, 0.2155, 0.5432, 0.2428, -0.0207],
                [-0.1548, 0.0148, 0.0938, -0.5813, 0.1622, 0.0895, -0.1405],
                [-0.0420, 0.1480, 0.3519, -0.0164, 0.4030, 0.2037, -0.0245],
                [-0.0833, 0.0013, 0.1317, 0.0175, 0.1614, 0.0347, -0.0946],
                [-0.0872, -0.0965, -0.0377, -0.1285, -0.0278, -0.0795, -0.1208]],

               [[-0.0992, -0.0845, -0.0436, -0.1067, -0.0231, -0.0653, -0.1092],
                [-0.0554, -0.0030, 0.1150, 0.0344, 0.1440, 0.0310, -0.0667],
                [-0.0189, 0.0792, 0.2779, 0.0239, 0.3277, 0.1258, -0.0357],
                [-0.1332, -0.0789, -0.0770, -0.5205, -0.0130, -0.0233, -0.1462],
                [-0.0319, 0.0514, 0.1537, -0.1904, 0.2039, 0.0922, -0.0436],
                [-0.0469, -0.0360, 0.0212, -0.0998, 0.0549, -0.0134, -0.0840],
                [-0.0216, -0.0706, -0.0475, -0.1278, -0.0355, -0.0638, -0.0796]]],

              [[[-0.0101, -0.0666, -0.0535, -0.1586, -0.1162, -0.0506, 0.0681],
                [-0.0261, -0.1030, -0.0093, -0.0851, -0.1213, -0.1032, 0.0767],
                [-0.0571, -0.1893, 0.0737, 0.0151, -0.0537, -0.1927, 0.0625],
                [-0.1086, -0.3115, -0.2670, 0.0720, -0.4147, -0.3294, 0.0200],
                [-0.0146, -0.1566, -0.1850, -0.4709, -0.2806, -0.1781, 0.0895],
                [-0.0134, -0.0923, -0.0948, -0.2101, -0.1173, -0.0734, 0.0592],
                [0.0716, -0.0123, 0.0375, 0.0021, 0.0691, 0.0320, 0.1131]],

               [[0.0499, 0.0655, 0.1020, 0.0020, 0.0364, 0.0478, 0.0807],
                [0.1124, 0.1200, 0.2327, 0.1548, 0.1173, 0.0773, 0.1549],
                [0.1250, 0.0855, 0.3481, 0.2514, 0.1976, 0.0147, 0.1544],
                [0.0666, -0.0505, -0.0267, 0.2032, -0.1979, -0.1322, 0.1035],
                [0.1716, 0.1224, 0.1037, -0.2229, -0.0135, 0.0513, 0.2036],
                [0.1333, 0.1516, 0.1687, 0.0253, 0.1166, 0.1217, 0.1455],
                [0.1263, 0.1361, 0.2108, 0.1505, 0.2050, 0.1324, 0.1161]],

               [[0.0896, 0.0162, -0.0085, -0.0998, -0.0468, 0.0299, 0.1535],
                [0.0868, -0.0380, -0.0203, -0.1008, -0.1079, -0.0548, 0.1513],
                [0.0422, -0.1618, -0.0108, -0.0951, -0.1250, -0.1986, 0.0991],
                [-0.0319, -0.3257, -0.4103, -0.1099, -0.5384, -0.3648, 0.0378],
                [0.0707, -0.1412, -0.2830, -0.6167, -0.3756, -0.1858, 0.1257],
                [0.0932, -0.0135, -0.0888, -0.2427, -0.1235, -0.0279, 0.1184],
                [0.1653, 0.0948, 0.1230, 0.0737, 0.1317, 0.1026, 0.1608]]],

              [[[0.0066, -0.0242, -0.0136, -0.1578, -0.0372, -0.0241, 0.0257],
                [0.0047, -0.0665, 0.0376, -0.0989, 0.0304, -0.0713, 0.0001],
                [0.0043, -0.0818, 0.2166, 0.0540, 0.2827, -0.0504, -0.0181],
                [-0.1103, -0.2681, -0.1715, -0.2849, -0.0963, -0.2396, -0.1298],
                [0.0359, -0.0476, 0.0448, -0.2982, 0.0705, -0.0529, 0.0294],
                [0.0478, -0.0422, -0.0303, -0.2225, -0.0058, -0.0527, 0.0283],
                [0.1137, 0.0410, 0.0547, -0.0451, 0.0908, 0.0469, 0.0959]],

               [[-0.0201, -0.0532, -0.0532, -0.1929, -0.0654, -0.0540, -0.0149],
                [-0.0293, -0.0954, 0.0042, -0.1147, 0.0154, -0.0939, -0.0423],
                [-0.0428, -0.1076, 0.2131, 0.0799, 0.2977, -0.0665, -0.0695],
                [-0.1807, -0.3099, -0.1839, -0.2975, -0.0973, -0.2698, -0.1969],
                [-0.0568, -0.1277, -0.0191, -0.3510, 0.0117, -0.1214, -0.0503],
                [-0.0585, -0.1401, -0.1356, -0.3301, -0.1168, -0.1496, -0.0669],
                [0.0098, -0.0504, -0.0437, -0.1575, -0.0246, -0.0524, -0.0019]],

               [[-0.1005, -0.0734, -0.0158, -0.1182, -0.0114, -0.0576, -0.0857],
                [-0.0510, 0.0091, 0.2302, 0.1742, 0.2623, 0.0304, -0.0533],
                [-0.0107, 0.1154, 0.6176, 0.5798, 0.7246, 0.1815, -0.0196],
                [-0.1116, -0.0197, 0.3286, 0.3583, 0.4384, 0.0446, -0.1107],
                [0.0117, 0.1432, 0.4441, 0.2151, 0.4902, 0.1610, 0.0262],
                [-0.0278, 0.0297, 0.1646, 0.0401, 0.1932, 0.0166, -0.0420],
                [-0.0255, -0.0216, 0.0491, -0.0242, 0.0681, -0.0390, -0.0538]]]]

# ssim v2
window_v15 = [[[[-0.0243, -0.0190, 0.0012, 0.0023, -0.0078, -0.0269, -0.0307],
                [-0.0295, -0.0055, 0.0324, 0.0380, 0.0221, -0.0148, -0.0343],
                [-0.0163, 0.0287, 0.0926, 0.1078, 0.0855, 0.0208, -0.0182],
                [-0.0111, 0.0429, 0.1166, 1.1134, 0.1136, 0.0373, -0.0098],
                [-0.0104, 0.0364, 0.1037, 0.1255, 0.1022, 0.0302, -0.0091],
                [-0.0184, 0.0088, 0.0473, 0.0584, 0.0429, 0.0012, -0.0200],
                [-0.0075, -0.0021, 0.0158, 0.0207, 0.0140, -0.0064, -0.0124]],

               [[-0.0424, -0.0503, -0.0392, -0.0388, -0.0420, -0.0462, -0.0339],
                [-0.0647, -0.0643, -0.0423, -0.0393, -0.0471, -0.0610, -0.0538],
                [-0.0621, -0.0502, -0.0091, 0.0016, -0.0121, -0.0482, -0.0521],
                [-0.0603, -0.0438, 0.0036, 0.9954, 0.0032, -0.0418, -0.0493],
                [-0.0584, -0.0491, -0.0087, 0.0042, -0.0091, -0.0480, -0.0475],
                [-0.0555, -0.0584, -0.0437, -0.0399, -0.0457, -0.0596, -0.0491],
                [-0.0266, -0.0400, -0.0377, -0.0384, -0.0390, -0.0409, -0.0265]],

               [[-0.0241, -0.0319, -0.0228, -0.0208, -0.0239, -0.0275, -0.0145],
                [-0.0453, -0.0521, -0.0391, -0.0379, -0.0420, -0.0480, -0.0332],
                [-0.0451, -0.0481, -0.0232, -0.0157, -0.0246, -0.0460, -0.0351],
                [-0.0464, -0.0493, -0.0194, 0.9754, -0.0196, -0.0487, -0.0376],
                [-0.0479, -0.0572, -0.0350, -0.0266, -0.0356, -0.0584, -0.0414],
                [-0.0465, -0.0630, -0.0595, -0.0589, -0.0620, -0.0655, -0.0446],
                [-0.0187, -0.0394, -0.0416, -0.0423, -0.0430, -0.0413, -0.0237]]],

              [[[-0.0472, -0.0503, -0.0450, -0.0488, -0.0512, -0.0498, -0.0409],
                [-0.0564, -0.0525, -0.0416, -0.0391, -0.0467, -0.0544, -0.0519],
                [-0.0604, -0.0495, -0.0211, -0.0008, -0.0238, -0.0509, -0.0561],
                [-0.0619, -0.0469, 0.0025, 1.0544, 0.0026, -0.0431, -0.0523],
                [-0.0642, -0.0571, -0.0285, -0.0014, -0.0226, -0.0500, -0.0509],
                [-0.0584, -0.0553, -0.0459, -0.0390, -0.0448, -0.0503, -0.0473],
                [-0.0464, -0.0493, -0.0449, -0.0409, -0.0425, -0.0448, -0.0398]],

               [[-0.0184, -0.0108, 0.0014, -0.0031, -0.0064, -0.0121, -0.0136],
                [-0.0112, 0.0098, 0.0316, 0.0343, 0.0244, 0.0059, -0.0071],
                [-0.0007, 0.0312, 0.0688, 0.0854, 0.0622, 0.0236, -0.0028],
                [0.0012, 0.0383, 0.0946, 1.1321, 0.0885, 0.0326, 0.0007],
                [-0.0022, 0.0271, 0.0668, 0.0900, 0.0659, 0.0255, 0.0019],
                [-0.0100, 0.0120, 0.0317, 0.0383, 0.0280, 0.0100, -0.0051],
                [-0.0161, -0.0059, 0.0051, 0.0089, 0.0053, -0.0053, -0.0127]],

               [[-0.0212, -0.0258, -0.0263, -0.0358, -0.0363, -0.0296, -0.0170],
                [-0.0323, -0.0367, -0.0390, -0.0456, -0.0480, -0.0410, -0.0255],
                [-0.0417, -0.0491, -0.0477, -0.0433, -0.0533, -0.0532, -0.0355],
                [-0.0499, -0.0600, -0.0462, 0.9811, -0.0498, -0.0598, -0.0402],
                [-0.0442, -0.0581, -0.0590, -0.0517, -0.0608, -0.0588, -0.0347],
                [-0.0305, -0.0400, -0.0508, -0.0568, -0.0579, -0.0452, -0.0248],
                [-0.0153, -0.0237, -0.0310, -0.0346, -0.0344, -0.0270, -0.0129]]],

              [[[-0.0160, -0.0243, -0.0245, -0.0272, -0.0286, -0.0295, -0.0192],
                [-0.0268, -0.0392, -0.0419, -0.0467, -0.0429, -0.0391, -0.0239],
                [-0.0317, -0.0460, -0.0398, -0.0397, -0.0390, -0.0448, -0.0279],
                [-0.0384, -0.0513, -0.0382, 0.9619, -0.0371, -0.0498, -0.0300],
                [-0.0374, -0.0517, -0.0446, -0.0421, -0.0438, -0.0504, -0.0286],
                [-0.0326, -0.0426, -0.0440, -0.0519, -0.0479, -0.0421, -0.0220],
                [-0.0202, -0.0251, -0.0270, -0.0326, -0.0301, -0.0261, -0.0108]],

               [[-0.0191, -0.0285, -0.0303, -0.0343, -0.0319, -0.0293, -0.0200],
                [-0.0317, -0.0448, -0.0495, -0.0560, -0.0477, -0.0407, -0.0269],
                [-0.0386, -0.0530, -0.0490, -0.0520, -0.0442, -0.0477, -0.0330],
                [-0.0485, -0.0611, -0.0499, 0.9405, -0.0459, -0.0560, -0.0372],
                [-0.0483, -0.0628, -0.0538, -0.0526, -0.0507, -0.0577, -0.0363],
                [-0.0440, -0.0554, -0.0552, -0.0623, -0.0567, -0.0520, -0.0312],
                [-0.0284, -0.0353, -0.0367, -0.0415, -0.0375, -0.0337, -0.0172]],

               [[-0.0360, -0.0345, -0.0229, -0.0187, -0.0193, -0.0306, -0.0366],
                [-0.0305, -0.0121, 0.0188, 0.0288, 0.0223, -0.0060, -0.0272],
                [-0.0174, 0.0224, 0.0858, 0.1079, 0.0890, 0.0265, -0.0148],
                [-0.0145, 0.0383, 0.1200, 1.1434, 0.1226, 0.0401, -0.0103],
                [-0.0177, 0.0281, 0.1001, 0.1293, 0.1013, 0.0295, -0.0130],
                [-0.0288, 0.0026, 0.0466, 0.0579, 0.0418, 0.0016, -0.0227],
                [-0.0335, -0.0182, 0.0033, 0.0077, -0.0006, -0.0203, -0.0270]]]]

# Normalize
mean = np.array([0.408, 0.447, 0.470], dtype=np.float32).reshape(1, 1, 3)
std = np.array([0.289, 0.274, 0.278], dtype=np.float32).reshape(1, 1, 3)

# Convolution
'''def privacy_third(img):
    out = np.zeros((1200,1600,3))

    image_data = ((img / 255. - mean) / std).astype(np.float32)
    for j in range(3):
        kernel = np.flip(np.flip(np.array(window_v7[0][j]), 0), 1)
        tmp = cv2.filter2D(image_data[:,:,j],-1, kernel, borderType=cv2.BORDER_CONSTANT)
        out[:,:,j] = tmp

    return np.sum(out, axis = 2)'''


# Convolution
def privacy_conv(img):
    H = img.shape[0]
    W = img.shape[1]
    out = np.zeros((H, W, 3))  # ((1200,1600,3))
    image_data = ((img / 255. - mean) / std).astype(np.float32)
    for i in range(3):
        channel = []
        for j in range(3):
            kernel = np.flip(np.flip(np.array(window_v13[i][j]), 0), 1)  # np.array(window[i][j])
            tmp = cv2.filter2D(image_data[:, :, j], -1, kernel, borderType=cv2.BORDER_CONSTANT)
            channel.append(tmp)
        channel_result = sum(channel)
        out[:, :, i] = channel_result

    return out


def privacy_conv_back(img):
    out = np.zeros((1200, 1600, 3))
    image_data = ((img / 255. - mean) / std).astype(np.float32)
    for i in range(3):
        channel = []
        for j in range(1):
            kernel = np.flip(np.flip(np.array(window_v10_back[i][j]), 0), 1)  # np.array(window[i][j])
            tmp = cv2.filter2D(image_data[:, :, j], -1, kernel, borderType=cv2.BORDER_CONSTANT)
            channel.append(tmp)
        channel_result = sum(channel)
        out[:, :, i] = channel_result

    return out


# @jit(nopython=True)
def scipy_conv(img, kernel):
    image_data = ((img / 255. - mean) / std).astype(np.float32)

    # kernel = np.flip(np.flip(np.array(window[2]), 0), 1)
    result = ndimage.convolve(img, kernel, mode='constant', cval=0.0)

    return result


# @vectorize(target="parallel")
def scipy_signal(img, kernel):
    image_data = ((img / 255. - mean) / std).astype(np.float32)

    # kernel = np.flip(np.flip(np.array(window[2]), 0), 1)
    result = signal.convolve(img, kernel)

    return result


def fft(array):
    out = np.fft.ifftshift(np.fft.fftn(np.fft.fftshift(array)))
    return out


def ifft(array):
    out = np.fft.fftshift(np.fft.ifftn(np.fft.ifftshift(array)))
    return out


def fft_conv(img):
    image_data = ((img / 255. - mean) / std).astype(np.float32)

    kernel = np.flip(np.flip(np.array(window[2]), 0), 1)
    conv = np.abs(ifft(np.matmul(fft(img), fft(kernel))))

    return conv


def fft_conv2(img):
    kernel = np.flip(np.flip(np.array(window[2]), 0), 1)
    result = signal.fftconvolve(img, kernel, mode='full')

    return result


# @vectorize(target="parallel")
def my_convolution(img, kernel):
    result = my_conv(img, kernel)
    return result


def privacy_encode(img):
    '''jpeg compression encode'''
    encode_img = cv2.imencode('.jpg', img)[1]
    ndarray_encode_img = np.array(encode_img)
    return ndarray_encode_img


def sigmoid(X):
    return 1 / (1 + np.exp(-1 * X))


def psnr(img1, img2):
    # mse = np.mean( (img1/255. - img2/255.) ** 2 )
    mse = np.mean((img1 - img2) ** 2)
    if mse < 1.0e-10:
        return 100
    PIXEL_MAX = 1

    return 20 * math.log10(PIXEL_MAX / math.sqrt(mse))




folder = '/home/kobe/CenterNet_Easy_Pytorch/data/Virtual_victor_v1/images/*.png'  # '/home/henry/fisheye_human_pose/val/images/*.jpg'#'/media/henry/My Passport/0905_demo/demo_data/*.jpg'#
save_folder = '/home/kobe/CenterNet_Easy_Pytorch/data/Virtual_victor_v1/images_privacy/'  # '/home/henry/fisheye_human_pose_privacy/privacy_edge/victor_rgb/images/'
if not os.path.exists(save_folder):
    os.mkdir(save_folder)
file_list = glob.glob(folder)

tanh_function = False
tanh_recover = False
conv_back = False

for i in range(len(file_list)):
    name = file_list[i]
    print(name)
    img = cv2.imread(name)  # cv2.imread("/home/henry/fisheye_victor/pic49.jpg")##

    conv_img = privacy_conv(img)
    if conv_back:
        conv_img = privacy_conv_back(conv_img)

    conv_img = sigmoid(conv_img)

    if tanh_function:
        result = np.tanh(conv_img) / 2 + 0.5  # (np.tanh(privacy_conv(img)) + 1) / 2
        save_result = result * 255

    if tanh_recover:
        read_result = np.where(read_result == 255, 254.9999, read_result)
        read_result = np.where(read_result == 0, 0.005, read_result)
        recover = np.arctanh((result - 0.5) * 2)

    # cv2.imshow('test', conv_img)
    # cv2.waitKey(500)
    file_list_temp = file_list[i].split('/')
    save_name = file_list_temp[len(file_list_temp) - 1]
    cv2.imwrite(save_folder + save_name, conv_img * 255)







